version
*) v6.2
   this program is tailorized to updating blackist domains
   at BIND9 - Response Policy Zone 
----------------------------------

author:
   ngadimin@warnet-ersa.net

licence:
   These program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.

   These program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with these program; if not, write to the Free Software
   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA.

what's new in v6.2:
*) add urls in grab_urls. now containing 22 lines.
      optimizing reduce porn domains in trust+ category, with changing to
      'shallalist porn-category' as identifyer porn domains
*) major fix

file parts of this version:
   1. grab_http.sh --grabing and proccessing raw domains.
        run this script as long as the below script and rpz.* are available in
        the same directory. IF no option is selected, it just generates a txt.*
        which is not free from duplication
   2. grab_dedup.sh --removing duplicate entries between domain lists.
        run this scipt separately, only if txt.* are available in the same directory.
   3. grab_build.sh --rewriting to BIND9-rpz format.
        run this scipt separately, only if txt.* are available in the same directory.
        it generated db.* files
   4. grab_cereal.sh --incrementing serial zones.
        run this scipt separately, only if rpz.* are available in the same directory.
        if not, it try to get from bind9-server. it generated new serial at zone-files
   5. grab_lib.sh --contain some of functions.
        need modify. SEE prerequisites section in this README
   6. grab_urls --contain urls list of remote raw-files.
        case sensitive, strict order, line count and no blank lines
   7. grab_regex --contain reguler expressions.
        case sensitive, strict order, line count and no blank lines
   8. grab_scp.sh --syncronizing updated db.* and rpz.* files to BIND9-server.
        in addition to synchronizing, this script also generates a tar file to bakcup
        old db.* and rpz.* files in BIND9-server. use below to decompress

        ~$ unpigz -v rpz-2022-04-09.tar.gz
        ~$ tar -xvf rpz-2022-04-09.tar

   9. rpz.adultaa rpz.adultab rpz.adultac rpz.adultad rpz.adultae rpz.adultaf
        rpz.adultag rpz.ipv4 rpz.malware rpz.publicite rpz.redirector rpz.trust+
  10. all of them must present in the same directory

prerequisites:
*) on your linux desktop workstation

      ~$ sudo apt policy curl dos2unix faketime rsync libnet-netmask-perl
      ~$ sudo apt install -y curl dos2unix faketime rsync libnet-netmask-perl

      # change to your fqdn BIND9-server OR ip-address, ie. your.fqdn.net
      ~$ grep -n "HOST=" *.sh
      grab_lib.sh:17:HOST="rpz.warnet-ersa.net"      # CHANGE to fqdn or ip-address of your BIND9-server
      ~$ sed -i.bak "s/rpz.warnet-ersa.net/your.fqdn.net/" grab_lib.sh
      # OR if you use IP-address, ie. 192.168.0.1
      ~$ sed -i.bak "s/rpz.warnet-ersa.net/192.168.0.1/" grab_lib.sh

      # BIND9-server will reboot after synchronizing, due to low RAM. but you can
      #   change to 'rdnc reload', by modify grab_lib.sh at line :
      # comment IN line: 161-163
      ~$ grep -n '\(fake\|shutdown\)' grab_lib.sh
      ~$ sed -i.bak '161,163s/./#&/' grab_lib.sh
      # comment OUT line: 167-168
      ~$ grep -n '[rR]eload' grab_lib.sh 
      167:      #printf "Reload BIND9-server:%s\n" "$HOST"
      168:      #ssh root@"$HOST" "rndc reload"
      ~$ sed -i '167s/^.*$/      printf "Reload BIND9-server:%s\n" "$HOST"/' grab_lib.sh
      ~$ sed -i '168s/^.*$/      ssh root@"$HOST" "rndc reload"/' grab_lib.sh

      # afterward, you can change to your policy trigger
      $ grep -n '\sCNAME\s\.' grab_lib.sh
      227:   awk '{print $0" IN CNAME .""\n""*."$0" IN CNAME ."}' "$2" >> "$1"
      233:   awk -F. '{print $5"."$4"."$3"."$2"."$1".rpz-nsip"" CNAME ."}' "$2" >> "$1"
      # change to your redirect page, ie. foo.redirect.page
      ~$ sed -i "s/\sCNAME\s\./ CNAME foo.redirect.page/g" grab_lib.sh

*) on your BIND9-server
      ~$ apt policy pigz rsync
      ~$ apt install -y pigz rsync

*) passwordless ssh
      your linux desktop and BIND9-server, both must configure to use passwordless for
      ssh, scp dan rsync connections. you can reffer to :
      https://github.com/ngadmini/Grabbing-Blacklist-for-Bind9-RPZ/wiki/Passwordless-SSH

*) reconfigure your bind9-server to run RPZ BIND9-fiture. you can reffer to :
      https://github.com/ngadmini/Grabbing-Blacklist-for-Bind9-RPZ/wiki/Fitting-Environment

usage:
*) execute grab_http.sh with non root privileges either directly as a root user or by use
      of sudo command, from your linux desktop workstation then follow the next step

output:
*) db.adultaa db.adultab db.adultac db.adultad db.adultae db.adultaf db.adultag
      db.ipv4 db.malware db.publicite db.redirector db.trust+
*) rpz.adultaa rpz.adultab rpz.adultac rpz.adultad rpz.adultae rpz.adultaf rpz.adultag
      rpz.ipv4 rpz.malware rpz.publicite rpz.redirector rpz.trust+
*) txt.adult txt.ipv4 txt.malware txt.publicite txt.redirector txt.trust+ 

disclaimer:
*) These program are as they are, and to be used at your own risk

please use our discussion for questions, feedback and bug fixes:
*) https://github.com/ngadmini/Grabbing-Blacklist-for-Bind9-RPZ/discussions
